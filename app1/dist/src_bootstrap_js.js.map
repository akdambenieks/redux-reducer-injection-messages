{"version":3,"sources":["webpack://@redux-reducer-injection-messages/app1/./src/bootstrap.js","webpack://@redux-reducer-injection-messages/app1/./src/store.js"],"names":["dynamicFederation","scope","module","container","window","init","__webpack_share_scopes__","default","get","then","factory","Module","RemoteApp","React","RemoteApp2","App","displayApp2","toggleDisplayApp2","useState","displayApp3","toggleDisplayApp3","store","ReactDOM","document","getElementById","CHANGE_LANGUAGE","TOGGLE_APP2","TOGGLE_APP3","initialState","appName","language","hostReducer","state","action","type","payload","currentDisplay","staticReducers","host","configureStore","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","enhancer","createStore","createReducer","asyncReducers","injectReducer","key","asyncReducer","console","log","replaceReducer","combineReducers","selectors","getDisplayApp2","getState","getDisplayApp3"],"mappings":"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","file":"src_bootstrap_js.js","sourcesContent":["import React, { Suspense, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport { store } from './store';\n\nconst dynamicFederation = async (scope, module) => {\n  const container = window[scope]; // or get the container somewhere else\n  // Initialize the container, it may provide shared modules\n  await container.init(__webpack_share_scopes__.default);\n  return container.get(module).then((factory) => {\n    const Module = factory();\n    return Module;\n  });\n};\n\nconst RemoteApp = React.lazy(() => dynamicFederation('app2', './RemoteApp'));\n\nconst RemoteApp2 = React.lazy(() => dynamicFederation('app3', './RemoteApp2'));\n\nconst App = () => {\n  const [displayApp2, toggleDisplayApp2] = useState(false);\n  const [displayApp3, toggleDisplayApp3] = useState(false);\n  return (\n    <Provider store={store}>\n      <div>\n        Welcome to Host App\n        <div>\n          <Suspense fallback=\"Loading...\">\n            <div>\n              <button onClick={() => toggleDisplayApp2(!displayApp2)}>Show/Hide App2</button>\n            </div>\n            {displayApp2 &&\n              <RemoteApp store={store} />\n            }\n            <div>\n              <button onClick={() => toggleDisplayApp3(!displayApp3)}>Show/Hide App3</button>\n            </div>\n            {displayApp3 &&\n              <RemoteApp2 store={store} />\n            }\n          </Suspense>\n        </div>\n      </div>\n    </Provider>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById('root'));\n","import { combineReducers, createStore, compose } from 'redux';\n\nconst CHANGE_LANGUAGE = 'HOST/CHANGE_LANGUAGE'\nconst TOGGLE_APP2 = 'HOST/TOGGLE_APP2'\nconst TOGGLE_APP3 = 'HOST/TOGGLE_APP3'\n\nconst initialState = {\n  appName: 'host',\n  language: 'en',\n  displayApp2: false,\n  displayApp3: false\n};\n\nconst hostReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case CHANGE_LANGUAGE: {\n      return {\n        ...state,\n        language: action.payload,\n      };\n    }\n    case TOGGLE_APP2: {\n      const currentDisplay = state.displayApp2;\n      return {\n        ...state,\n        displayApp2: !currentDisplay\n      }\n    }\n    case TOGGLE_APP3: {\n      const currentDisplay = state.displayApp3;\n      return {\n        ...state,\n        displayApp3: !currentDisplay\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nconst staticReducers = {\n  host: hostReducer,\n};\n\n/**\n * Cf. redux docs:\n * https://redux.js.org/recipes/code-splitting/#defining-an-injectreducer-function\n */\nexport default function configureStore(initialState) {\n  const composeEnhancers =\n    typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})\n      : compose;\n\n  const enhancer = composeEnhancers();\n  const store = createStore(createReducer(), enhancer);\n\n  store.asyncReducers = {};\n\n  store.injectReducer = (key, asyncReducer) => {\n    console.log('key: ', key)\n    store.asyncReducers[key] = asyncReducer;\n    store.replaceReducer(createReducer(store.asyncReducers));\n  };\n\n  return store;\n}\n\nfunction createReducer(asyncReducers) {\n  return combineReducers({\n    ...staticReducers,\n    ...asyncReducers,\n  });\n}\n\nexport const store = configureStore();\n\nexport const selectors = {\n  getDisplayApp2: () => store.getState().displayApp2,\n  getDisplayApp3: () => store.getState().displayApp3\n}\n"],"sourceRoot":""}