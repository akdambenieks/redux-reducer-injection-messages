{"version":3,"sources":["webpack://@redux-reducer-injection-messages/app1/./src/store.js","webpack://@redux-reducer-injection-messages/app1/./src/constants.js","webpack://@redux-reducer-injection-messages/app1/./src/components/LanguageToggle.jsx","webpack://@redux-reducer-injection-messages/app1/./src/components/Counter.jsx","webpack://@redux-reducer-injection-messages/app1/./src/components/Messages.jsx","webpack://@redux-reducer-injection-messages/app1/./src/bootstrap.js"],"names":["CHANGE_LANGUAGE","ENQUEUE_MESSAGE","DEFAULT_LANGUAGE","INITIAL_COUNT","initialState","appName","language","messages","hostReducer","state","action","type","payload","console","log","result","staticReducers","host","configureStore","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","enhancer","store","createStore","createReducer","asyncReducers","injectReducer","key","asyncReducer","replaceReducer","combineReducers","actions","enqueueMessage","message","selectors","getMessages","getLanguage","reduce","acc","getCount","parseInt","LANGUAGE_OPTIONS","LanguageToggle","dispatch","useDispatch","useSelector","dispatchChangeLanguageMessage","e","currentTarget","id","option","Counter","count","dispatchIncrementCountMessage","dispatchDecrementCountMessage","Messages","length","dynamicFederation","scope","module","container","init","__webpack_share_scopes__","default","get","then","factory","Module","RemoteApp","React","RemoteApp2","App","displayApp2","toggleDisplayApp2","useState","displayApp3","toggleDisplayApp3","ReactDOM","document","getElementById"],"mappings":"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","file":"616.js","sourcesContent":["import { combineReducers, createStore, compose } from 'redux';\n\nexport const CHANGE_LANGUAGE = 'GLOBAL/CHANGE_LANGUAGE';\nexport const ENQUEUE_MESSAGE = 'GLOBAL/ENQUEUE_MESSAGE';\nconst DEFAULT_LANGUAGE = 'en';\nconst INITIAL_COUNT = 0;\n\nconst initialState = {\n  appName: 'host',\n  language: 'en',\n  messages: []\n};\n\nconst hostReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case CHANGE_LANGUAGE: {\n      return {\n        ...state,\n        language: action.payload,\n      };\n    }\n    case ENQUEUE_MESSAGE: {\n      console.log('Action in host',action)\n      return {\n        ...state,\n        messages: [...state.messages, action.payload]\n      }\n      console.log('Result', result)\n    }\n    default:\n      return state;\n  }\n  return result\n};\n\nconst staticReducers = {\n  host: hostReducer,\n};\n\n/**\n * Cf. redux docs:\n * https://redux.js.org/recipes/code-splitting/#defining-an-injectreducer-function\n */\nexport default function configureStore(initialState) {\n  const composeEnhancers =\n    typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})\n      : compose;\n\n  const enhancer = composeEnhancers();\n  const store = createStore(createReducer(), enhancer);\n\n  store.asyncReducers = {};\n\n  store.injectReducer = (key, asyncReducer) => {\n    store.asyncReducers[key] = asyncReducer;\n    store.replaceReducer(createReducer(store.asyncReducers));\n  };\n\n  return store;\n}\n\nfunction createReducer(asyncReducers) {\n  return combineReducers({\n    ...staticReducers,\n    ...asyncReducers,\n  });\n}\n\nexport const store = configureStore();\n\nexport const actions = {\n  enqueueMessage: (message) => ({\n    type: ENQUEUE_MESSAGE,\n    payload: message\n  })\n}\n\nexport const selectors = {\n  getMessages: (state) => state.host.messages,\n  getLanguage: (state) => {\n    return state.host.messages.reduce((acc, message) => {\n      if (message.type === 'CHANGE_LANGUAGE') {\n        acc = message.payload\n      };\n      return acc;\n    }, DEFAULT_LANGUAGE);\n  },\n  getCount: (state) => {\n    return state.host.messages.reduce((acc, message) => {\n      if (message.type === 'UPDATE_COUNT') {\n        acc = acc + parseInt(message.payload, 10)\n      };\n      return acc;\n    }, INITIAL_COUNT)\n  }\n}\n","export const LANGUAGE_OPTIONS = ['en', 'fr'];","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectors, actions, CHANGE_LANGUAGE } from '../store'\nimport { LANGUAGE_OPTIONS } from '../constants';\n\nconst { getLanguage } = selectors;\nconst { enqueueMessage } = actions;\n\nconst LanguageToggle = () => {\n  const dispatch = useDispatch();\n  const language = useSelector(state => getLanguage(state));\n  const dispatchChangeLanguageMessage = e => dispatch(enqueueMessage({ type: CHANGE_LANGUAGE, payload: e.currentTarget.id }))\n\n  return (\n    <>\n      <p>Current Language: {language}</p>\n      <p>Change Language:</p>\n      {LANGUAGE_OPTIONS.map((option) => (\n        <button\n          onClick={e => dispatchChangeLanguageMessage(e)}\n          id={option}\n          key={option}\n          disabled={language === option}\n        >\n          {option}\n        </button>\n      ))}\n    </>\n  )\n}\n\nexport default LanguageToggle;","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectors, actions } from '../store'\n\nconst { getCount } = selectors;\nconst { enqueueMessage } = actions;\n\nconst Counter = () => {\n  const dispatch = useDispatch();\n  const count = useSelector(state => getCount(state));\n  const dispatchIncrementCountMessage = () => dispatch(enqueueMessage({ type: 'UPDATE_COUNT', payload: 1 }));\n  const dispatchDecrementCountMessage = () => dispatch(enqueueMessage({ type: 'UPDATE_COUNT', payload: -1 }));\n  return (\n    <>\n      <p>Current Count: {count}</p>\n      <div>\n        <button onClick={dispatchIncrementCountMessage}>Increment</button>\n        <button onClick={dispatchDecrementCountMessage}>Decrement</button>\n      </div>\n    </>\n  )\n}\n\nexport default Counter;","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { selectors } from '../store';\nconst { getMessages } = selectors;\n\nconst { getCount } = selectors;\nconst Messages = () => {\n  const messages = useSelector(getMessages)\n  return (\n    <div>\n      You have {messages.length} message(s)\n    </div>\n  )\n}\n\nexport default Messages;","import React, { Suspense, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport LanguageToggle from './components/LanguageToggle';\nimport Counter from './components/Counter';\nimport Messages from './components/Messages';\n\nimport { store, selectors } from './store';\nconst { getMessages } = selectors;\n\nconst dynamicFederation = async (scope, module) => {\n  const container = window[scope]; // or get the container somewhere else\n  // Initialize the container, it may provide shared modules\n  await container.init(__webpack_share_scopes__.default);\n  return container.get(module).then((factory) => {\n    const Module = factory();\n    return Module;\n  });\n};\n\nconst RemoteApp = React.lazy(() => dynamicFederation('app2', './RemoteApp'));\n\nconst RemoteApp2 = React.lazy(() => dynamicFederation('app3', './RemoteApp2'));\n\nconst App = () => {\n  const [displayApp2, toggleDisplayApp2] = useState(false);\n  const [displayApp3, toggleDisplayApp3] = useState(false);\n  return (\n    <Provider store={store}>\n      <div>\n        Welcome to Host App\n        <LanguageToggle />\n        <Counter />\n        <Messages />\n        <div>\n          <Suspense fallback=\"Loading...\">\n            <div>\n              <button onClick={() => toggleDisplayApp2(!displayApp2)}>Show/Hide App2</button>\n            </div>\n            {displayApp2 &&\n              <RemoteApp store={store} />\n            }\n            <div>\n              <button onClick={() => toggleDisplayApp3(!displayApp3)}>Show/Hide App3</button>\n            </div>\n            {displayApp3 &&\n              <RemoteApp2 store={store} />\n            }\n          </Suspense>\n        </div>\n      </div>\n    </Provider>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}